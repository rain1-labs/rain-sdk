# Rain SDK Documentation

## Overview

Rain SDK is designed as a **clean, modular, and extensible TypeScript SDK** for interacting with Rain markets and preparing on-chain transactions.

The SDK is intentionally split into two layers:

* **Rain** → Stateless, public-facing utilities (data fetching, raw transaction builders)
* **RainAA** → Stateful Account Abstraction layer (smart accounts)

---

## Installation

```bash
npm install @rainprotocolsdk/sdk
```

or

```bash
yarn add @rainprotocolsdk/sdk
```

---

### Initialization

```ts
import { Rain } from "@rainprotocolsdk/sdk";

const rain = new Rain();
```

> The constructor is intentionally empty to allow future configuration without breaking changes.

---

## getPublicMarkets

Fetches public market data from the Rain backend.

### Method Signature

```ts
getPublicMarkets(params: GetMarketsParams): Promise<Market[]>;
```

### Parameters

```ts
interface GetMarketsParams {
  limit: number;
  offset: number;
  sortBy?: "Liquidity" | "Volumn" | "latest";
  status?: 'Live' | 'New' | 'WaitingForResult' | 'UnderDispute' | 'UnderAppeal' | 'ClosingSoon' | 'InReview' | 'InEvaluation' | 'Closed' | 'Trading';
}
```

### Example

```ts
const markets = await rain.getPublicMarkets({
  limit?: 12,
  offset?: 1,
  sortBy?: "Liquidity",
  status?: "Live",
});
```

---

## buildBuyOptionRawTx

Builds a **raw EVM transaction** for entering a market option.

This function **does not send the transaction** — it only prepares calldata.

### Method Signature

```ts
buildBuyOptionRawTx(params: EnterOptionTxParams): RawTransaction;
```

### Parameters

```ts
interface EnterOptionTxParams {
  address: `0x${string}`;        // Trademarket contract address
  selectedOption: number;       // Option index
  buyInWei: bigint;              // Amount in wei
}
```

### Return Type

```ts
interface RawTransaction {
  to: `0x${string}`;
  data: `0x${string}`;
}
```

### Example

```ts
const rawTx = rain.buildBuyOptionRawTx({
  address: `0x${string}`,
  selectedOption: 1,
  buyInWei: 1000000000000000000n,
});
```
---

## buildApprovalTx

```
Builds a raw ERC20 approval transaction if needed.

This function prepares an unsigned approve(spender, amount) transaction and does not execute it.

If amount is not provided, a default large allowance is approved.
```

### Return Type

```ts
interface RawTransaction {
  to: `0x${string}`;
  data: `0x${string}`;
}
```

### Example

```ts
const approvalTx = rain.buildApprovalTx({ 
  tokenAddress: `0x${string}`, // Approval token address 
  spender: `0x${string}`,  // Market contract address
  amount?: 1000000000000000000n // optional parameter
   });
```

---

## RainAA Class (Account Abstraction)

`RainAA` is responsible for:

* Smart account creation
* Session management (coming soon)
* Gas-sponsored execution (coming soon)
* Transaction submission (coming soon)

> `RainAA` consumes raw transactions generated by `Rain`.

### Conceptual Flow

```ts
Rain (WHAT to do)
   ↓
Raw Transaction
   ↓
RainAA (HOW to execute)
```

## Versioning Policy

Rain SDK follows **Semantic Versioning**:

* **Patch** (`1.0.x`) → Bug fixes
* **Minor** (`1.x.0`) → New features, backward compatible
* **Major** (`x.0.0`) → Breaking API changes

---

## Recommended Usage Pattern

```ts
// 1. Read data / build tx
const rain = new Rain();
const rawTx = rain.buildBuyOptionRawTx(...);

// 2. Execute via your provider
await yourprovider.sendTransaction(rawTx);
```

---

**Rain SDK** is built to scale with both products and protocols.
